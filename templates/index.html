<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Recommender</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Movie Recommender</h1>
        <div class="row">
            <div class="col-md-3">
                <input type="text" class="form-control mb-3" id="search-bar" placeholder="Search for a movie...">
                <div id="movies-list" class="list-group">
                    <!-- Movie list will be populated here -->
                </div>
            </div>
            <div class="col-md-9">
                <form action="/recommend" method="post">
                    <input type="text" class="form-control" id="selected-movie" name="movie_title" readonly>
                    <button type="submit" class="btn btn-primary mt-3">Get Recommendations</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Fetch movie titles and populate the list
        function fetchMovies() {
            let query = $("#search-bar").val().toLowerCase();
            if (query.length < 2) {
                $("#movies-list").empty();
                return;
            }
            $.getJSON("movies.json", function(data) {
                let filteredMovies = data.filter(movie => movie.title.toLowerCase().includes(query));
                let listItems = "";
                filteredMovies.slice(0, 10).forEach(movie => {
                    listItems += `<button type="button" class="list-group-item list-group-item-action" onclick="selectMovie('${movie.title}')">${movie.title}</button>`;
                });
                $("#movies-list").html(listItems);
            });
        }

        // Set the selected movie title
        function selectMovie(title) {
            $("#selected-movie").val(title);
            $("#movies-list").empty();
        }

        // Attach event listener to the search bar
        $("#search-bar").on("input", fetchMovies);
    </script>
</body>
</html>
